const childProcess = require('child_process');

function runTask(callback) {
  // verificar que el callback no se ejecute mas de una vez
  var invoked = false;
  const process = childProcess.fork('./src/config/server');

  process.on('error', (err) => {
    if (invoked) return;
    invoked = true;
    callback(err);
  });

  process.on('exit', (code) => {
    if (invoked) return;
    invoked = true;
    const err = code === 0 ? null : new Error('exit code ' + code);
    callback(err);
  });

}

runTask((err) => {
  if (err) console.log(err);
  console.log('El servidor est√° corriendo');
});