const childProcess = require('child_process');

function runTask(callback) {
  // verificar que el callback no se ejecute mas de una vez
  var invoked = false;
  const process = childProcess.fork('./src/config/server');

  process.on('error', (err) => {
    if (invoked) return;
    invoked = true;
    callback(err);
    console.log('Error process');
  });

  process.on('exit', (code) => {
    if (invoked) return;
    invoked = true;
    const err = code === 0 ? null : new Error(`exit code ${code}`);
    callback(err);
    console.log('Exit process');
  });

}

runTask((err) => {
  if (err) throw err;
  console.log('El servidor est√° corriendo');
});